# 数据库事务简介

[toc]

## 事务四大特性

![image-20220304152359473](https://s2.loli.net/2022/03/04/DR69tju8fUVHs2x.png)

- 原子性：事务是不可分割的最小单元，要么全部执行成功，要么全部失败
- 一致性：事务完成时，必须使所有的数据啊都保持一致的状态
- 隔离性：各个事务的运行互不干扰，互不影响，各自在独立的环境运行
- 持久性：事务的提交或回滚对数据库数据的改变就是于永久的。



> 数据库的四大特性简称：ACID



## 并发事务

![image-20220304152731002](https://s2.loli.net/2022/03/04/fhcrgiIlFeLY7M5.png)

事务的并发问题：

- 脏读：一个事务读取了另一事务还未提交的数据。

![image-20220304153241188](https://s2.loli.net/2022/03/04/jbnTWrgh4OSxPYV.png)

- 不可重复读：一个事务先后读取的同一条记录，但是两次读取的数据不同，称之为不可重复读。

![image-20220304153222360](https://s2.loli.net/2022/03/04/Bv4NukJYCqUmDA7.png)

- 幻读：一个事务按照条件查询数据时，没有对应的数据行，但是在插入数据时，又发现了数据已经存在了，好像出现了"幻影"。

![image-20220304153333388](https://s2.loli.net/2022/03/04/oCPIEKmGWN1xl2H.png)





## 事务的隔离级别

事务的隔离级别就是用来解决事务的并发的问题的：

![image-20220304153617099](https://s2.loli.net/2022/03/04/pvdcUHLiBQZWDjq.png)



- 读未提交：MySQL 数据库的默认隔离级别，会出现`脏读`，`幻读`，`不可重复读`。
- 读已提交：解决了`脏读` 问题，但是不能保证其他两种问题。
- 可重复读：可以保证解决`脏读` 和 `幻读` 问题。
- 串行化：可以解决事务并发的几个问题，但是数据处理的速度较低。

![image-20220304153957111](https://s2.loli.net/2022/03/04/XUit1v9TjK2wxgS.png)